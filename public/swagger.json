{
    "openapi": "3.0.1",
    "info": {
        "title": "Next Swagger API Aqua-Track",
        "version": "1.0"
    },
    "servers": [
        {
            "url": "http://localhost:3000/api"
        },
        {
            "url": "https://aqua-track-olive.vercel.app/api"
        }
    ],
    "tags": [
        {
            "name": "Users",
            "description": "Operations related to user management"
        },
        {
            "name": "Water",
            "description": "Operations related to water entries"
        },
        {
            "name": "Auth",
            "description": "Authentication operations"
        }
    ],
    "components": {
        "securitySchemes": {
            "cookieAuth": {
                "type": "apiKey",
                "in": "cookie",
                "name": "next-auth.session-token",
                "description": "Authentication using a session token stored in a cookie. The cookie name is 'next-auth.session-token'. This token is used to authenticate requests and manage user sessions. You can find it in your browser's dev tools under the Cookies section, but next-auth automatically substitutes the token."
            },
            "OAuth2": {
                "type": "oauth2",
                "description": "OAuth2 authentication with support for multiple providers like Google.",
                "flows": {
                    "authorizationCode": {
                        "authorizationUrl": "https://accounts.google.com/o/oauth2/auth",
                        "tokenUrl": "https://oauth2.googleapis.com/token",
                        "refreshUrl": "https://oauth2.googleapis.com/token",
                        "scopes": {
                            "openid": "OpenID Connect scope",
                            "profile": "Access to basic profile information",
                            "email": "Access to the user's email"
                        }
                    }
                }
            }
        },
        "schemas": {
            "WaterEntry": {
                "type": "object",
                "properties": {
                    "_id": {
                        "type": "string",
                        "description": "Id of water entry",
                        "example": "66d6c013157ef1c67f7f096e"
                    },
                    "user": {
                        "type": "string",
                        "description": "ID of the user"
                    },
                    "date": {
                        "type": "string",
                        "format": "date-time",
                        "description": "Date of the water entry"
                    },
                    "volume": {
                        "type": "number",
                        "description": "Volume of water consumed"
                    },
                    "createdAt": {
                        "type": "string",
                        "format": "date-time",
                        "description": "Timestamp of when the entry was created"
                    },
                    "updatedAt": {
                        "type": "string",
                        "format": "date-time",
                        "description": "Timestamp of the last update"
                    }
                },
                "required": ["user", "date", "volume"]
            },
            "User": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "nullable": true,
                        "example": null
                    },
                    "email": {
                        "type": "string",
                        "format": "email",
                        "example": "kurkayetra@gufum.com"
                    },
                    "image": {
                        "type": "string",
                        "nullable": true,
                        "example": null
                    },
                    "id": {
                        "type": "string",
                        "example": "66e159b9d94b57c78830d8aa"
                    },
                    "gender": {
                        "type": "string",
                        "enum": ["woman", "man"],
                        "example": "woman"
                    },
                    "activeTime": {
                        "type": "number",
                        "format": "float",
                        "example": 0
                    },
                    "weight": {
                        "type": "number",
                        "format": "float",
                        "example": 0
                    },
                    "volume": {
                        "type": "number",
                        "format": "float",
                        "example": 1.8
                    }
                }
            },
            "UserSession": {
                "type": "object",
                "properties": {
                    "user": {
                        "$ref": "#/components/schemas/User"
                    },
                    "expires": {
                        "type": "string",
                        "format": "date-time",
                        "example": "2024-10-11T09:43:23.309Z"
                    }
                }
            }
        }
    },
    "paths": {
        "/auth/providers": {
            "get": {
                "tags": ["Auth"],
                "summary": "Callback URL for providers",
                "description": "Handles the response from providers after authentication.",
                "responses": {
                    "200": {
                        "description": "Successfully handled provider response"
                    },
                    "401": {
                        "description": "User not authenticated or error occurred"
                    }
                }
            }
        },
        "/auth/csrf": {
            "get": {
                "tags": ["Auth"],
                "summary": "Get CSRF token",
                "description": "Returns a CSRF token to secure requests.",
                "responses": {
                    "200": {
                        "description": "CSRF token"
                    }
                }
            }
        },
        "/auth/signin/google": {
            "post": {
                "tags": ["Auth"],
                "summary": "Sign-in through the specified provider",
                "description": "Authenticates the user via the selected provider.",
                "security": [
                    {
                        "OAuth2": ["openid", "profile", "email"]
                    }
                ],
                "requestBody": {
                    "description": "Authentication data",
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "csrfToken": {
                                        "type": "string",
                                        "description": "CSRF token for security",
                                        "example": "c4a0350112b456810d26fc20d9e8e0ffdd2d6b8b705dafdfd18c8903a2ac7b8e"
                                    },
                                    "callbackUrl": {
                                        "type": "string",
                                        "description": "URL to redirect after authentication",
                                        "example": "http://localhost:3000/signin"
                                    },
                                    "json": {
                                        "type": "boolean",
                                        "description": "Whether to redirect or not",
                                        "example": true
                                    }
                                },
                                "required": [
                                    "provider",
                                    "email",
                                    "password",
                                    "csrfToken",
                                    "callbackUrl",
                                    "redirect"
                                ]
                            },
                            "examples": {
                                "googleExample": {
                                    "summary": "Example for Google provider",
                                    "value": {
                                        "csrfToken": "c4a0350112b456810d26fc20d9e8e0ffdd2d6b8b705dafdfd18c8903a2ac7b8e",
                                        "callbackUrl": "http://localhost:3000/signin",
                                        "json": true
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful authentication"
                    },
                    "401": {
                        "description": "Invalid credentials or provider not found"
                    }
                }
            }
        },
        "/auth/callback/credentials": {
            "post": {
                "tags": ["Auth"],
                "summary": "Sign-in through the specified provider",
                "description": "Authenticates the user via the selected provider.",
                "requestBody": {
                    "description": "Authentication data",
                    "content": {
                        "application/json": {
                            "schema": {
                                "oneOf": [
                                    {
                                        "type": "object",
                                        "properties": {
                                            "provider": {
                                                "type": "string",
                                                "example": "google"
                                            }
                                        },
                                        "required": ["provider"]
                                    },
                                    {
                                        "type": "object",
                                        "properties": {
                                            "provider": {
                                                "type": "string",
                                                "example": "credentials"
                                            },
                                            "email": {
                                                "type": "string",
                                                "description": "User email for credential-based login",
                                                "example": "user@example.com"
                                            },
                                            "password": {
                                                "type": "string",
                                                "description": "User password for credential-based login",
                                                "example": "password123"
                                            },
                                            "csrfToken": {
                                                "type": "string",
                                                "description": "CSRF token for security",
                                                "example": "c4a0350112b456810d26fc20d9e8e0ffdd2d6b8b705dafdfd18c8903a2ac7b8e"
                                            },
                                            "callbackUrl": {
                                                "type": "string",
                                                "description": "URL to redirect after authentication",
                                                "example": "http://localhost:3000/signin"
                                            },
                                            "redirect": {
                                                "type": "boolean",
                                                "description": "Whether to redirect or not",
                                                "example": false
                                            }
                                        },
                                        "required": [
                                            "provider",
                                            "email",
                                            "password",
                                            "csrfToken",
                                            "callbackUrl",
                                            "redirect"
                                        ]
                                    }
                                ]
                            },
                            "examples": {
                                "googleExample": {
                                    "summary": "Example for Google provider",
                                    "value": {
                                        "csrfToken": "c4a0350112b456810d26fc20d9e8e0ffdd2d6b8b705dafdfd18c8903a2ac7b8e",
                                        "callbackUrl": "http://localhost:3000/signin",
                                        "json": true
                                    }
                                },
                                "credentialsExample": {
                                    "summary": "Example for Credentials provider",
                                    "value": {
                                        "provider": "credentials",
                                        "email": "user@example.com",
                                        "password": "password123",
                                        "csrfToken": "c4a0350112b456810d26fc20d9e8e0ffdd2d6b8b705dafdfd18c8903a2ac7b8e",
                                        "callbackUrl": "http://localhost:3000/signin",
                                        "redirect": false
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful authentication"
                    },
                    "401": {
                        "description": "Invalid credentials or provider not found"
                    }
                }
            }
        },
        "auth/signout": {
            "post": {
                "tags": ["Auth"],
                "summary": "User sign-out",
                "description": "Terminates the user's session.",
                "responses": {
                    "200": {
                        "description": "Successful sign-out"
                    },
                    "401": {
                        "description": "User not authenticated"
                    }
                }
            }
        },
        "/auth/session": {
            "get": {
                "tags": ["Auth"],
                "summary": "Get current session information",
                "description": "Returns information about the user's current session.",
                "responses": {
                    "200": {
                        "ref$": "#/components/schemas/UserSession",
                        "description": "Current user session"
                    },
                    "401": {
                        "description": "User not authenticated"
                    }
                }
            }
        }
    }
}
